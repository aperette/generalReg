data3=data.frame(X = c(588.345170556568, 528.556770319119, 597.928864159621, 
                       649.897583737038, 574.234853684902, 611.580484034494, 630.293527594768, 
                       697.339672013186, 475.243282015435, 670.261558727361, 408.358452143148, 
                       635.988165508024, 505.266011808999, 451.918963971548, 642.605178779922, 
                       558.337703929283, 568.345877924003, 617.330860625952, 578.137313434854, 
                       426.128600607626, 670.04635524936, 556.479114410467, 511.989412805997, 
                       699.628734774888, 525.845733145252, 515.741876442917, 528.081908891909, 
                       636.88081423752, 526.230311696418, 692.071030149236, 685.294406511821, 
                       611.439691879787, 434.854997135699, 511.995867150836, 465.661898185499, 
                       486.24925550539, 571.833843551576, 447.997379093431, 419.880444859155, 
                       581.774520105682, 411.342347436585, 486.791818961501, 408.579077525064, 
                       541.579290572554, 658.962461492047, 634.496436733752, 596.130085946061, 
                       687.183856451884, 512.959969649091, 463.202418410219), Y = c(319.052970434019, 
                                                                                    187.919041333104, 338.512556032995, 618.952373991282, 198.173928462456, 
                                                                                    186.777003307688, 403.808478375039, 981.578930882331, 102.329460894468, 
                                                                                    688.542034601814, 101.749043722499, 435.071028537184, 114.283502821524, 
                                                                                    65.2115898452302, 479.381322205643, 341.657000448144, 143.562395058002, 
                                                                                    314.026646058586, 277.925970677426, -10.0713156619442, 447.175333390639, 
                                                                                    67.7755189655238, 204.933895578734, 938.653670950167, 134.731441532968, 
                                                                                    139.134431550942, 295.450001907644, 610.470595557977, 130.298911910623, 
                                                                                    577.266966790672, 923.970483813298, 410.311549584402, 1.44072304218812, 
                                                                                    135.970051359013, 139.675749561305, 148.635562791212, 312.243767682821, 
                                                                                    8.50950210332517, 48.6055405705419, 202.669449220948, 14.1023252051191, 
                                                                                    187.869173397219, 33.9051741006073, 35.2324480864177, 530.735491792397, 
                                                                                    494.836653761154, 264.904243596351, 620.392242753941, 95.9765979346418, 
                                                                                    166.763152664641))

fit1=generalReg::reg_general(Y~exp(beta1+beta2*X),~exp(sigma1+sigma2*X),data=data3,
                             start = list(beta1=0.2,beta2=0.01,sigma1=2,sigma2=0.01),
                             bias_correction = F,
                             control=list(reltol = 1e-10, max_it = 5000,kappa=1,verbose=5))

system.time(expr={
  fit2=generalReg::reg_general(Y~exp(beta1+beta2*X),~exp(sigma1+sigma2*X),data=data3,
                               start = list(beta1=0.2,beta2=0.01,sigma1=2,sigma2=0.01),
                               bias_correction = F,
                               control=list(reltol = 1e-10, max_it = 5000,kappa="AUTO",verbose=1))
  
})

system.time(expr={
  fit3=generalReg::reg_general(Y~exp(beta1+beta2*X),~exp(sigma1+sigma2*X),data=data3,
                               start = list(beta1=0.2,beta2=0.01,sigma1=2,sigma2=0.01),
                               bias_correction = F,
                               control=list(reltol = 1e-10, max_it = 5000,kappa=0.2,verbose=5))
})

if(method=="optim"){
  opt = optim(unlist(theta_val)),
                     fn=function(par){
                       aux=-log_like(par,data)
                       if(is.na(aux)) aux=Inf
                       return(aux)},
                     control=list(maxit=control$max_it,reltol=control$reltol,
                                  trace=control$verbose,REPORT=control$verbose))
  k=opt$counts[2]
  if(opt$convergence==1)
    stop("Maximal number of iterations reached",call. = F)
  theta_val_novo = opt$par
  names(theta_val_novo)=theta
  theta_val=data.frame(valor=logit(opt$par),nome=theta) %>% tidyr::spread(nome,valor)
  dif=NA
}
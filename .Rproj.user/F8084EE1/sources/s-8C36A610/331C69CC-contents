if(method=="gamlss"){
  theta_names = names(start)
  mu_names = theta_names[stringr::str_detect(mu,theta_names)]
  sigma_names = theta_names[stringr::str_detect(S,theta_names)]
  fit = gamlss.nl::nlgamlss(y=eval(parse(text={as.character(formula)[2]})),
                      mu.formula = =formula,
                      sigma=formula_var,
                      mu.start = unlist(start[mu_names]),
                      sigma.start = unlist(start[sigma_names]),
                      family=NO(sigma.link="identity"),
                      data=data)
  k=fit$iter
  theta_val_novo = fit$coefficients
  names(theta_val_novo)=theta
  theta_val=data.frame(valor=fit$coefficients,nome=theta) %>% tidyr::spread(nome,valor)
}
